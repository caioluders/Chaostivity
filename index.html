<!DOCTYPE html>
<html>
<link type="text/css" rel="stylesheet" href="static/styles/style.css" />  
<link rel="stylesheet" type="text/css" href="static/styles/print_style.css" media="print" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"/>
<body>
<div id="top_div">
	<img src="static/images/WTF.png" id="wtf" onclick="wtf()" width="80" height="80" ></img>
	<img src="static/images/Reloada.png" id="reload" width="80" height="80" onclick="draw(document.getElementById('density').value,document.getElementById('opacity').value)"></img>
	<canvas width="230" height="80" id="title_background"></canvas>
	<a id="download_out"><img src="static/images/Sarvar.png" id="download" width="80" height="80"></img></a>
	<img src="static/images/Emprimiar.png" onclick="window.print()" width="80" height="80" id="print_it"></img>
</div>
<div id="mid_div">
	<canvas id="pareidolia" width="600" height="400" >	Your browser does not support the HTML5 canvas tag , sorry :'( </canvas>
</div>
<div id="foot_div">
	<p>Densidade</p><input id="density" type="range" min="0" max="100" onchange="draw(this.value,document.getElementById('opacity').value)" />
	<p>Opacidade</p><input id="opacity" type="range" min="0" max="100" onchange="draw(document.getElementById('density').value,this.value)" />
</div>

<script>
function draw( d , o ) {
	var c = document.getElementById("pareidolia");
	var ctx = c.getContext("2d");
	ctx.clearRect(0, 0, c.width, c.height);
	ctx.save()
	ctx.globalAlpha = parseInt(o)/100
	
	var ss = document.styleSheets;
    for (var i = 0, max = ss.length; i < max; i++) {
        if (ss[i].href == "static/styles/print_style.css") {
        	console.log("wtf") ;
            c.width = 2480;
        	c.height = 3508;
        }
    }

	for (var i = 0 ; i < parseInt(d) ; i++ ) {
		ctx.beginPath();
		ctx.moveTo( Math.floor((Math.random() * c.width)) ,Math.floor((Math.random() * c.height)));
		ctx.lineTo(Math.floor((Math.random() * c.width)),Math.floor((Math.random() * c.height)));
		ctx.lineWidth = 0.5;
		ctx.globalAlpha = parseInt(o)/100
		ctx.stroke();
	}

	for (var i = 0 ; i < parseInt(d) ; i++ ) {
		ctx.beginPath();
		ctx.moveTo( Math.floor((Math.random() * c.width)) ,Math.floor((Math.random() * c.height)));
		ctx.bezierCurveTo(Math.floor((Math.random() * c.width)), Math.floor((Math.random() * c.height)), Math.floor((Math.random() * c.width)), Math.floor((Math.random() * c.height)), Math.floor((Math.random() * c.width)), Math.floor((Math.random() * c.height)));
		ctx.lineWidth = 0.5;
		ctx.globalAlpha = parseInt(o)/100
		ctx.stroke();
	}

	ctx.restore()
}

function downloadCanvas(link, canvasId, filename) {
    link.href = document.getElementById(canvasId).toDataURL();
    link.download = filename;
}

document.getElementById('download_out').addEventListener('click', function() {
    downloadCanvas(this, 'pareidolia', 'pareidolia.png');
}, false);

function wtf() {
	alert("I don't know WTF IS THIS !");
}

function select_print(t) {
	console.log(t) ;
}

var canvas = document.getElementById("title_background");
var c = canvas.getContext("2d");

c.fillStyle = 'rgb(114,152,63)';
// c.roundRect(0, 0, 230, 80, {lowerLeft:10,lowerRight:10 , upperLeft:10 , upperRight:10}, true, false);
c.beginPath() ;
c.moveTo(10,0) ;
c.lineTo(220,0) ;
c.quadraticCurveTo(230 , 0 , 230 , 10 );
c.lineTo(230,70) ;
c.quadraticCurveTo(230 , 80 , 220 , 80 );
c.lineTo(10,70) ;
c.quadraticCurveTo(0 , 70 , 0 , 60 );
c.lineTo(0,10) ;
c.quadraticCurveTo(0 , 0 , 10 , 0 );
c.closePath() ;
c.fill() ;

c.fillStyle = "white";
c.shadowOffsetX = -3 ;
c.shadowOffsetY = 3 ;
c.shadowBlur = 0 ;
c.shadowColor = 'rgb(87,115,49)' ;
c.font = "35px Conv_Anothershabby_trial";
c.fillText("Chaostivity", 25, 50);

draw(50) ;

</script>

</body>
</html>
